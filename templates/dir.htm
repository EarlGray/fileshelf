{% extends "tmpl.htm" %}
{% block style %}
<style>
#dir-entries-header {
  border-bottom: 1px solid #aaa;
}
#dir-entries-header th {
  text-align: left;
  padding: 0.3em 0.5em;
}
#dir-entries-header th#deh-dl {
  padding: 0;
}

.dir-entry-row {
  margin-top: 0.2em;
  margin-bottom: 0.2em;
  padding: 0.3em 0;
}
.dir-entry-row:hover {
  background-color: #f8f8f8;
}
.dir-entry-row:hover .hoverable {
  display: inline-block;
}

.dir-entry-size {
  padding-left: 1em;
}
.dir-entry-name {
  word-wrap: break-word;
  min-width: 12em;
  max-width: 30em;
  padding-right: 1em;
}
.entry-em {
  font-weight: bold;
}
</style>
{% endblock %}
{% block body %}
<table id="dir-entries">
  <tr id="dir-entries-header">
    <th id="deh-dl"><object type="image/svg+xml" data="{{ url_for('static_handler', path='dl.svg') }}" 
          width="16" height="16"></th>
    <th>name &nbsp;</th>
    <!--th>type &nbsp;</th-->
    <th>size &nbsp;</th>
    <!--th>access &nbsp;</th-->
    <th>action &nbsp;</th>
  </tr>
  {% for entry in lsdir -%}
  <tr class="dir-entry-row">
    <td class="dir-entry-icon">
      <a href="{{ entry.href + '?dl' }}">
        <img src="{{ entry.icon_src }}" alt="{{ entry.icon_alt }}" width="16"/>
      </a>
    </td>
    <td class="dir-entry-name">
      {% if rename == entry.name -%}
      <form method="POST">
        <input type="hidden" name="action" value="rename">
        <input type="hidden" name="oldname" value="{{ entry.name }}">
        <input type="text" name="newname" value="{{ entry.name }}" autofocus>
        <input type="submit" value="rename">
      </form>
      {% elif entry.see_url -%}
      <a href="{{ entry.see_url }}">{{ entry.name }}</a>
      {% else -%}
      <a href="{{ entry.href }}">{{ entry.name }}</a>
      {% endif -%}
    </td>
    <!--td class="dir-entry-type">{{ entry.mime }}</td-->
    <td class="pull-right dir-entry-size">{{ entry.size }}</td>
    <!--td class="pull-right dir-entry-access">
      {% if entry.shared -%}
      <a class="entry-em" href="{{ entry.shared }}">public</a>
      {% elif not entry.isdir -%}
      <form class="hoverable" action="" method="POST">
        <input type="hidden" name="action" value="share">
        <input type="hidden" name="file" value="{{ entry.name }}">
        <input type="submit" name="share" value="share">
      </form>
      {% endif -%}
    </td-->
    <td class="dir-entry-action">
      {% if entry.rename_url -%}
      <a href="{{ entry.rename_url }}" class="hoverable">
        <input type="button" value="rename">
      </a>
      {% endif %}
      <form class="hoverable" action="" method="POST">
        <input type="hidden" name="action" value="delete">
        <input type="hidden" name="filename" value="{{ entry.name }}">
        <input type="submit" name="delete" value="delete">
      </form>
    </td>
  </tr>
  {% endfor -%}
</table>
<hr/>
<form action="" method="POST" enctype="multipart/form-data">
  <input type="hidden" name="action" value="upload">
  <input type="file" name="file"/>
  <input type="submit" name="upload" value="Upload"/>
</form>
{% endblock %}
